/* ── Base & scrollbar ──────────────────────────────────────────── */

* { box-sizing: border-box; }

.custom-scrollbar::-webkit-scrollbar { width: 4px; }
.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
.custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.08);
    border-radius: 9999px;
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgba(255,255,255,0.15);
}

/* ── Chat bubbles ─────────────────────────────────────────────── */

.msg-bot {
    background: linear-gradient(135deg, rgba(99,102,241,.08), rgba(139,92,246,.06));
    border: 1px solid rgba(99,102,241,.12);
    border-radius: 18px 18px 18px 4px;
    padding: 14px 18px;
    max-width: 85%;
    animation: fadeSlideIn .35s ease-out;
}

.msg-user {
    background: linear-gradient(135deg, #4f46e5, #6366f1);
    border-radius: 18px 18px 4px 18px;
    padding: 14px 18px;
    max-width: 75%;
    margin-left: auto;
    animation: fadeSlideIn .3s ease-out;
}

/* ── Markdown inside bot messages ────────────────────────────── */

.msg-bot p { margin-bottom: .5em; line-height: 1.65; }
.msg-bot p:last-child { margin-bottom: 0; }
.msg-bot strong { color: #c4b5fd; font-weight: 600; }
.msg-bot em { color: #a5b4fc; }
.msg-bot ul, .msg-bot ol { margin: .5em 0; padding-left: 1.4em; }
.msg-bot li { margin-bottom: .25em; }
.msg-bot code {
    background: rgba(255,255,255,.06);
    padding: 1px 5px;
    border-radius: 4px;
    font-size: .85em;
    color: #c4b5fd;
}
.msg-bot pre {
    background: rgba(0,0,0,.35);
    border: 1px solid rgba(255,255,255,.06);
    border-radius: 10px;
    padding: 12px 16px;
    margin: .75em 0;
    overflow-x: auto;
    font-size: .8em;
    line-height: 1.5;
}
.msg-bot pre code {
    background: none;
    padding: 0;
    color: #e2e8f0;
}
.msg-bot h1, .msg-bot h2, .msg-bot h3 {
    font-weight: 700;
    margin: .8em 0 .3em;
}
.msg-bot hr {
    border: none;
    border-top: 1px solid rgba(255,255,255,.08);
    margin: 1em 0;
}

/* ── Typing indicator ─────────────────────────────────────────── */

.typing-indicator {
    display: flex;
    gap: 4px;
    align-items: center;
    padding: 14px 20px;
}

.typing-dot {
    width: 7px; height: 7px;
    background: #6366f1;
    border-radius: 50%;
    animation: bounce .6s infinite alternate;
}
.typing-dot:nth-child(2) { animation-delay: .15s; }
.typing-dot:nth-child(3) { animation-delay: .3s; }

@keyframes bounce {
    to { transform: translateY(-6px); opacity: .4; }
}

/* ── Quick-start buttons ──────────────────────────────────────── */

.quick-start-btn {
    padding: 6px 14px;
    font-size: .75rem;
    font-weight: 500;
    color: #a5b4fc;
    background: rgba(99,102,241,.08);
    border: 1px solid rgba(99,102,241,.15);
    border-radius: 999px;
    cursor: pointer;
    transition: all .2s;
}
.quick-start-btn:hover {
    background: rgba(99,102,241,.18);
    border-color: rgba(99,102,241,.3);
    transform: translateY(-1px);
}

/* ── Tree nodes ───────────────────────────────────────────────── */

.tree-node {
    padding: 6px 10px;
    border-radius: 8px;
    font-size: .78rem;
    cursor: default;
    transition: background .2s;
    display: flex;
    align-items: center;
    gap: 6px;
}
.tree-node:hover { background: rgba(255,255,255,.03); }

.tree-node.mastered  { color: #34d399; }
.tree-node.learning  { color: #fbbf24; }
.tree-node.pending   { color: #6b7280; }
.tree-node.concept   { color: #a5b4fc; }

.tree-children {
    margin-left: 18px;
    border-left: 1px solid rgba(255,255,255,.06);
    padding-left: 8px;
}

/* ── Animations ───────────────────────────────────────────────── */

@keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(8px); }
    to   { opacity: 1; transform: translateY(0); }
}

@keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 8px rgba(99,102,241,.2); }
    50%      { box-shadow: 0 0 20px rgba(99,102,241,.4); }
}

.glow-pulse { animation: pulse-glow 2s infinite; }

/* ── Sidebar responsive ───────────────────────────────────────── */

@media (max-width: 1023px) {
    .sidebar {
        position: fixed;
        left: -320px;
        top: 0; bottom: 0;
        z-index: 50;
        transition: left .3s ease;
    }
    .sidebar.open { left: 0; }
    .sidebar-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,.5);
        z-index: 40;
        display: none;
    }
    .sidebar-overlay.show { display: block; }
}
